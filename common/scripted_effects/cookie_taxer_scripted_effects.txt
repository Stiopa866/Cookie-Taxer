# purchase_upgrade = { type = x }

purchase_upgrade = {
	#custom_tooltip = $type$_upgrade_tt
	hidden_effect = {
		change_variable = {
			which = $type$_count
			value = 1
		}

		set_variable = {
			which = $type$_count_2
			which = $type$_count
		}
		
		subtract_variable = {
			which = $type$_count_2
			value = 1
		}
		
		subtract_longs = { ln1 = cookies ln2 = $type$ }
		
		based_on_var_and_plus_one_fire = { var = $type$_count functor = change_upgrade arg_1 = $type$ arg_1_name = type }
		
		get_$type$_cost = yes
	}
}

#change_upgrade = { current = int next = int+1 type = modifierprefix }

change_upgrade = {
	if = {
		limit = {
			has_country_modifier = $type$_$current$
		}
		remove_country_modifier = $type$_$current$
	}
	add_country_modifier = {
		name = $type$_$next$
		duration = -1
	}
}

# purchase_building = { type = x }

purchase_building = {
	change_variable = {
		which = num_of_$x$
		value = 1
	}
	
	based_on_var_fire = { var = num_of_$x$ functor = purchase_building_cost }
}

assign_mod_to_random_province = { #count #mod
	set_variable = { which = mc value = $count$ }
	while = {
		limit = {
			check_variable = { which = mc value = 1 }
		}
		subtract_variable = {
			which = mc
			value = 1
		}
		random_province = {
			limit = {
				AND = {
					continent = europe
					NOT = { has_province_flag = ct_modifier_applied }
					owner = { ai = yes }
				}
			}
			set_province_flag = ct_modifier_applied
			add_permanent_province_modifier = {
				name = $mod$
				duration = -1
			}
		}
	}
}

